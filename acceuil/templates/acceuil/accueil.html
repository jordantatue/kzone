{% extends 'acceuil/base.html' %}
{% load static %}

{% block title %}Accueil | Cam-Retail Express{% endblock %}

{% block body_class %}bg-body-secondary{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'acceuil/css/accueil.css' %}">
{% endblock %}

{% block main_class %}container-fluid px-3 px-lg-4 py-3 flex-grow-1{% endblock %}

{% block content %}
<div class="row g-3">
    <aside class="col-lg-3 d-none d-lg-block">
        <div id="catalog-sidebar" class="card border-0 shadow-sm p-3">
            {% include 'acceuil/partials/catalog_sidebar.html' %}
        </div>
    </aside>

    <section class="col-12 col-lg-9" data-filter-url="{% url 'acceuil:catalogue_filtrer' %}">
        <div class="card border-0 overflow-hidden home-page__hero mb-3">
            <div class="row g-0 align-items-center">
                <div class="col-md-7 p-4 p-lg-5">
                    <h1 class="display-6 fw-bold text-white mb-2">Envoyez de l'amour au Cameroun</h1>
                    <p class="fs-3 fw-semibold text-white mb-0">Livraison en 24h</p>
                </div>
                <div class="col-md-5">
                    <img
                        src="https://images.unsplash.com/photo-1542838132-92c53300491e?auto=format&fit=crop&w=1200&q=80"
                        class="img-fluid w-100 h-100 object-fit-cover"
                        alt="Produits frais">
                </div>
            </div>
        </div>

        <form id="catalog-filter-form" class="card border-0 shadow-sm p-3 mb-3" method="get">
            {% csrf_token %}
            <input type="hidden" name="categorie" id="catalog-category" value="{{ filtres.categorie }}">
            <div class="row g-3 align-items-end">
                <div class="col-md-4">
                    <label class="form-label" for="catalog-region">Region</label>
                    <select class="form-select" name="region" id="catalog-region">
                        <option value="">Toutes les regions</option>
                        {% for region in regions %}
                            <option value="{{ region }}" {% if filtres.region == region %}selected{% endif %}>{{ region }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label" for="catalog-city">Ville</label>
                    <select class="form-select" name="ville" id="catalog-city">
                        {% include 'acceuil/partials/catalog_city_options.html' %}
                    </select>
                </div>
                <div class="col-md-4 text-md-end">
                    <button class="btn btn-success" type="submit">Appliquer</button>
                    <a class="btn btn-outline-secondary" href="{% url 'acceuil:accueil' %}">Reinitialiser</a>
                </div>
            </div>
            <div id="catalog-context-filters" class="mt-3">
                {% include 'acceuil/partials/catalog_context_filters.html' %}
            </div>
        </form>

        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="h4 fw-bold mb-0">Catalogue disponible</h2>
            <span id="catalog-result-count" class="badge bg-success-subtle text-success-emphasis">{{ total_produits }} produits</span>
        </div>

        <div id="catalog-products">
            {% include 'acceuil/partials/catalog_products.html' %}
        </div>
    </section>
</div>
{% endblock %}

{% block javascript %}
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="{% static 'acceuil/js/catalogue_filters.js' %}"></script>
{% endblock %}

